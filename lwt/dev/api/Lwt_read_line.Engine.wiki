=Module <<a_api_type | module Lwt_read_line.Engine >> =
<<pre class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|module>> <<span class="ocsforge_color_uid"|<<span class="ocsforge_color_uid"|Engine>>>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="ocsforge_color_keyword"|sig>><<a_api text=".." | module Lwt_read_line.Engine >><<span class="ocsforge_color_keyword"|end>>>>~Engine

----

~Note~: this part know nothing about rendering or completion~.
<<pre class="ocsforge_color odocwiki_code" id="TYPEselection_state"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|selection~_state>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="ocsforge_color_delimiter"|~{>>
<<span class="odocwiki_record"|<<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|sel_text:>> <<span class="odocwiki_type"|<<span class="ocsforge_color_uid"|Text>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>><<span class="ocsforge_color_delimiter"|~;>> >><<span class="odocwiki_comments"|<<span class="odocwiki_comments_open"|(*>> <<span|<<div class="odocwiki_info"|~The whole input text on which the selection is working
>>
>><<span class="odocwiki_comments_close"| ~*)>>>>>><<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|sel_mark:>> <<span class="odocwiki_type"|<<span class="ocsforge_color_uid"|Text>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|pointer>>>><<span class="ocsforge_color_delimiter"|~;>> >><<span class="odocwiki_comments"|<<span class="odocwiki_comments_open"|(*>> <<span|<<div class="odocwiki_info"|~Pointer to the mark
>>
>><<span class="odocwiki_comments_close"| ~*)>>>>>><<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|sel_cursor:>> <<span class="odocwiki_type"|<<span class="ocsforge_color_uid"|Text>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|pointer>>>><<span class="ocsforge_color_delimiter"|~;>> >><<span class="odocwiki_comments"|<<span class="odocwiki_comments_open"|(*>> <<span|<<div class="odocwiki_info"|~Pointer to the cursor
>>
>><<span class="odocwiki_comments_close"| ~*)>>>>>>>><<span class="ocsforge_color_delimiter"|~}>>>><<div class="odocwiki_info"|~State when the user is doing selection~:
>>
<<pre class="ocsforge_color odocwiki_code" id="TYPEsearch_state"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|search~_state>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="ocsforge_color_delimiter"|~{>>
<<span class="odocwiki_record"|<<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|search_word:>> <<span class="odocwiki_type"|<<span class="ocsforge_color_uid"|Text>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>><<span class="ocsforge_color_delimiter"|~;>> >><<span class="odocwiki_comments"|<<span class="odocwiki_comments_open"|(*>> <<span|<<div class="odocwiki_info"|~The word we are looking for
>>
>><<span class="odocwiki_comments_close"| ~*)>>>>>><<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|search_history:>> <<span class="odocwiki_type"|<<a_api text="Lwt_read_line.history" | type Lwt_read_line.history >>>><<span class="ocsforge_color_delimiter"|~;>> >><<span class="odocwiki_comments"|<<span class="odocwiki_comments_open"|(*>> <<span|<<div class="odocwiki_info"|~Position in history~. ~The first element is a sentence
        containing the searched word
>>
>><<span class="odocwiki_comments_close"| ~*)>>>>>><<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|search_init_history:>> <<span class="odocwiki_type"|<<a_api text="Lwt_read_line.history" | type Lwt_read_line.history >>>><<span class="ocsforge_color_delimiter"|~;>> >><<span class="odocwiki_comments"|<<span class="odocwiki_comments_open"|(*>> <<span|<<div class="odocwiki_info"|~The initial history~, before searching for a word
>>
>><<span class="odocwiki_comments_close"| ~*)>>>>>>>><<span class="ocsforge_color_delimiter"|~}>>>><<div class="odocwiki_info"|~State when searching in the history
>>
<<pre class="ocsforge_color odocwiki_code" id="TYPEmode"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|mode>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="odocwiki_variants"|<<span class="odocwiki_variant"|<<span class="odocwiki_variant_constr"|<<span class="ocsforge_color_keyword"| ~|>> <<span class="ocsforge_color_uid"|Edition>> <<span class="ocsforge_color_keyword"|of>> <<span class="odocwiki_type"|<<a_api text="Lwt_read_line.edition_state" | type Lwt_read_line.edition_state >>>>>><<span class="odocwiki_comments"|<<span class="odocwiki_comments_open"|(*>> <<span|<<div class="odocwiki_info"|~The user is typing some text
>>
>><<span class="odocwiki_comments_close"| ~*)>>>>>><<span class="odocwiki_variant"|<<span class="odocwiki_variant_constr"|<<span class="ocsforge_color_keyword"| ~|>> <<span class="ocsforge_color_uid"|Selection>> <<span class="ocsforge_color_keyword"|of>> <<span class="odocwiki_type"|<<a_api text="selection_state" | type Lwt_read_line.Engine.selection_state >>>>>><<span class="odocwiki_comments"|<<span class="odocwiki_comments_open"|(*>> <<span|<<div class="odocwiki_info"|~The user is selecting some text
>>
>><<span class="odocwiki_comments_close"| ~*)>>>>>><<span class="odocwiki_variant"|<<span class="odocwiki_variant_constr"|<<span class="ocsforge_color_keyword"| ~|>> <<span class="ocsforge_color_uid"|Search>> <<span class="ocsforge_color_keyword"|of>> <<span class="odocwiki_type"|<<a_api text="search_state" | type Lwt_read_line.Engine.search_state >>>>>><<span class="odocwiki_comments"|<<span class="odocwiki_comments_open"|(*>> <<span|<<div class="odocwiki_info"|~The user is searching the given word in the history
>>
>><<span class="odocwiki_comments_close"| ~*)>>>>>>>>>><<div class="odocwiki_info"|~The engine mode~:
>>
<<pre class="ocsforge_color odocwiki_code" id="TYPEstate"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|state>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="ocsforge_color_delimiter"|~{>>
<<span class="odocwiki_record"|<<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|mode:>> <<span class="odocwiki_type"|<<a_api text="mode" | type Lwt_read_line.Engine.mode >>>><<span class="ocsforge_color_delimiter"|~;>> >>>><<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|history:>> <<span class="odocwiki_type"|<<a_api text="Lwt_read_line.history" | type Lwt_read_line.history >> * <<a_api text="Lwt_read_line.history" | type Lwt_read_line.history >>>><<span class="ocsforge_color_delimiter"|~;>> >><<span class="odocwiki_comments"|<<span class="odocwiki_comments_open"|(*>> <<span|<<div class="odocwiki_info"|~Cursor to the history position~.
>>
>><<span class="odocwiki_comments_close"| ~*)>>>>>>>><<span class="ocsforge_color_delimiter"|~}>>>><<div class="odocwiki_info"|~An engine state~:
>>
<<pre id="VALinit" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|init>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="Lwt_read_line.history" | type Lwt_read_line.history >> <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="state" | type Lwt_read_line.Engine.state >>>>>><<div class="odocwiki_info"|<<span class="odocwiki_inlinecode"|init history>> return a initial state using the given
        history
>>
<<pre id="VALreset" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|reset>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="state" | type Lwt_read_line.Engine.state >> <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="state" | type Lwt_read_line.Engine.state >>>>>><<div class="odocwiki_info"|<<span class="odocwiki_inlinecode"|reset state>> reset the given state~, if the user was doing a
        selection~, it is canceled
>>
<<pre id="VALupdate" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|update>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| engine_state: >><<a_api text="state" | type Lwt_read_line.Engine.state >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?clipboard: >><<a_api text="Lwt_read_line.clipboard" | class type Lwt_read_line.clipboard >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| command: >><<a_api text="Lwt_read_line.Command.t" | type Lwt_read_line.Command.t >> <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="state" | type Lwt_read_line.Engine.state >>>>>><<div class="odocwiki_info"|<<span class="odocwiki_inlinecode"|update ~~state ~?clipboard ~~command ~(~)>> update an engine state by
        processing the given command~. ~It returns the new state~, and
        may have the side effect of changing the clipboard contents~.


        <<span class="odocwiki_inlinecode"|clipboard>> defaults to the global clipboard~.
>>
<<pre id="VALedition_state" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|edition~_state>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="state" | type Lwt_read_line.Engine.state >> <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="Lwt_read_line.edition_state" | type Lwt_read_line.edition_state >>>>>><<div class="odocwiki_info"|~Returns the edition state of a state~, whatever its mode is~.
>>
<<pre id="VALall_input" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|all~_input>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="state" | type Lwt_read_line.Engine.state >> <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_uid"|Text>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Returns the current complete user input~.
>>
